{% extends 'base.html' %}

{% block content %}
<h2>All Blog Posts</h2>

{% for post in posts %}
    <div class="post-card">
        <h3><a href="{% url 'post-detail' post.pk %}">{{ post.title }}</a></h3>
        <p>{{ post.content|truncatewords:20 }}</p>
        <small>By {{ post.author }} on {{ post.created_at }}</small>
    </div>
{% empty %}
<p>No posts yet.</p>
{% endfor %}

{% if user.is_authenticated %}
    <a href="{% url 'post-create' %}" class="btn">Create New Post</a>
{% endif %}
{% endblock %}

{# inside post loop or detail view #}
{% if post.tags.all %}
  <p class="tags">
    Tags:
    {% for tag in post.tags.all %}
      <a href="{% url 'blog:posts-by-tag' tag.name %}" class="tag-link">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
    {% endfor %}
  </p>
{% endif %}

<form method="GET" action="{% url 'blog:search' %}" class="search-form">
    <input type="text" name="q" placeholder="Search posts or tags..." value="{{ request.GET.q|default_if_none:'' }}">
    <button type="submit">Search</button>
</form>
